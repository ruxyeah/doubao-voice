# ============================================================
# 豆包实时语音API服务配置文件
# ============================================================

# ------------------------------------------------------------
# 服务器配置
# ------------------------------------------------------------
server:
  # 服务端口号，客户端通过此端口访问REST API和WebSocket
  port: 8888

# ------------------------------------------------------------
# Spring应用配置
# ------------------------------------------------------------
spring:
  application:
    # 应用名称，用于日志和监控标识
    name: doubao-voice-api

# ------------------------------------------------------------
# 豆包API配置
# 获取方式：https://console.volcengine.com/speech/service/8
# ------------------------------------------------------------
doubao:
  api:
    # WebSocket API地址（豆包端到端实时语音对话接口）
    # 官方文档：https://www.volcengine.com/docs/6561/1329505
    url: wss://openspeech.bytedance.com/api/v3/realtime/dialogue

    # 应用ID（App ID）
    # 获取方式：火山引擎控制台 -> 语音技术 -> 实时语音对话 -> 应用管理
    # 支持环境变量：export DOUBAO_APP_ID=your-app-id
    app-id: ${DOUBAO_APP_ID:123123}

    # 访问密钥（Access Key）
    # 获取方式：火山引擎控制台 -> 语音技术 -> 实时语音对话 -> 应用管理 -> 查看密钥
    # 支持环境变量：export DOUBAO_ACCESS_KEY=your-access-key
    access-key: ${DOUBAO_ACCESS_KEY:key}

    # 资源ID（固定值，无需修改）
    # 表示调用的服务类型为语音对话
    resource-id: volc.speech.dialog

    # 应用密钥（固定值，无需修改）
    # 注意：这不是Secret Key，而是豆包实时语音API的公共固定值
    # 所有开发者都使用同一个值，无需从控制台获取
    app-key: PlgvMymc7f3tQnJ6

    # WebSocket连接超时时间（毫秒）
    # 建立连接的最大等待时间，超时将抛出异常
    connect-timeout: 10000

    # WebSocket读取超时时间（毫秒）
    # 等待服务器响应的最大时间
    read-timeout: 30000

    # WebSocket写入超时时间（毫秒）
    # 发送消息的最大等待时间
    write-timeout: 10000

  # ------------------------------------------------------------
  # 会话管理配置
  # ------------------------------------------------------------
  session:
    # 会话超时时间（毫秒）
    # 会话空闲超过此时间将被自动清理
    # 300000ms = 5分钟
    timeout: 300000

    # 最大并发会话数
    # 限制同时进行的语音对话数量，防止资源耗尽
    max-sessions: 100

    # 过期会话清理间隔（毫秒）
    # 定时任务检查并清理过期会话的频率
    # 60000ms = 1分钟
    cleanup-interval: 60000

  # ------------------------------------------------------------
  # TTS（语音合成）配置
  # 控制AI回复的语音输出
  # ------------------------------------------------------------
  tts:
    # 默认音色
    # O版本可用音色：zh_female_vv_jupiter_bigtts 等精品音色
    # SC版本可用音色：ICL_zh_female_* / ICL_zh_male_* 等克隆音色
    # SC2.0版本可用音色：saturn_zh_female_* / saturn_zh_male_* 等克隆音色
    # 完整音色列表请参考豆包官方文档
    default-speaker: zh_female_vv_jupiter_bigtts

    # TTS输出采样率（Hz）
    # 豆包API固定返回24kHz的音频
    sample-rate: 24000

    # TTS输出音频格式
    # pcm: 原始PCM格式（Float32），需要客户端解码播放
    # 其他格式请参考官方文档
    format: pcm

    # TTS输出声道数
    # 1: 单声道（默认）
    # 2: 双声道（立体声）
    channel: 1

  # ------------------------------------------------------------
  # ASR（语音识别）配置
  # 控制用户语音输入的识别行为
  # ------------------------------------------------------------
  asr:
    # ASR输入采样率（Hz）
    # 客户端发送的音频必须是16kHz采样率
    sample-rate: 16000

    # 停止说话判定延迟（毫秒）
    # 用户停止说话后，等待此时间再判定为说话结束
    # 较大的值可以容忍更长的停顿，但响应会变慢
    # 较小的值响应更快，但可能误判停顿为说话结束
    end-smooth-window-ms: 1500

    # 是否启用自定义VAD（语音活动检测）
    # true: 使用自定义VAD算法
    # false: 使用服务器默认VAD（推荐）
    enable-custom-vad: false

    # 是否启用ASR二次校验
    # true: 对识别结果进行二次校验，提高准确率但增加延迟
    # false: 不进行二次校验（推荐，实时性更好）
    enable-asr-twopass: false

  # ------------------------------------------------------------
  # 对话配置
  # 控制AI对话的行为和角色设定
  # ------------------------------------------------------------
  dialog:
    # 机器人名称
    # 用于AI自我介绍时使用的名字
    default-bot-name: 豆包

    # 系统角色设定（System Prompt）
    # 定义AI的角色、性格、能力范围等
    # 示例："你是一个专业的客服助手，擅长解答产品相关问题"
    default-system-role: ""

    # 说话风格
    # 定义AI的语气和表达方式
    # 示例："温柔亲切"、"专业严谨"、"活泼幽默"
    default-speaking-style: ""

    # 模型版本
    # O      - 基础版本，支持精品音色
    # SC     - 支持声音复刻（需要先在控制台训练自定义音色）
    # 1.2.1.0 - O2.0版本（规范版本号）
    # 2.2.0.0 - SC2.0版本（规范版本号）
    default-model: O

    # 是否启用联网搜索
    # true: AI可以搜索互联网获取实时信息
    # false: AI仅使用训练数据回答（默认）
    enable-web-search: false

    # 接收超时时间（秒）
    # 等待AI回复的最大时间
    recv-timeout: 10

    # 是否启用严格内容审核
    # true: 对用户输入和AI输出进行严格审核
    # false: 使用默认审核策略（推荐）
    strict-audit: false

# ------------------------------------------------------------
# 日志配置
# ------------------------------------------------------------
logging:
  level:
    # 根日志级别
    # TRACE < DEBUG < INFO < WARN < ERROR
    root: INFO

    # 本项目日志级别
    # 开发环境建议使用DEBUG，生产环境建议使用INFO
    com.doubao.voice: DEBUG

  pattern:
    # 控制台日志格式
    # %d: 时间戳
    # %thread: 线程名
    # %level: 日志级别
    # %logger: 类名
    # %msg: 日志消息
    # %n: 换行符
    console: "%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"
